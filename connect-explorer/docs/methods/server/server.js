const bitcore=require("bitcore-lib"),{PublicKey}=bitcore,{BufferWriter}=bitcore.encoding,{Signature,ECDSA,Hash}=bitcore.crypto,{sha256sha256,sha256}=Hash;function verify(e,f,r,a,i){let c;if(e=Buffer.from(e,"hex"),f=Buffer.from(f),r=new PublicKey(Buffer.from(r,"hex")),a=Signature.fromCompact(Buffer.from(a,"hex")),1===i)c=Buffer.concat([e,f]);else{if(2!==i)throw new Error("Unknown version");c=Buffer.concat([sha256(e),sha256(f)])}const b=Buffer.from("Bitcoin Signed Message:\n"),n=BufferWriter.varintBufNum(b.length),t=BufferWriter.varintBufNum(c.length),u=Buffer.concat([n,b,t,c]),o=sha256sha256(u);return ECDSA.verify(o,a,r)}const hidden="cd8552569d6e4509266ef137584d1e62c7579b5b8ed69bbafa4b864c6521e7c2",visual="2015-03-23 17:39:22",pubKey="023a472219ad3327b07c18273717bb3a40b39b743756bf287fbd5fa9d263237f45",signature="20f2d1a42d08c3a362be49275c3ffeeaa415fc040971985548b9f910812237bb41770bf2c8d488428799fbb7e52c11f1a3404011375e4080e077e0e42ab7a5ba02";console.log(verify(hidden,visual,pubKey,signature,2));